<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Login - Jehovah Jire Ministry</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
        }
        .login-container {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .login-box {
            background: white;
            border-radius: 10px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            padding: 2rem;
            width: 100%;
            max-width: 400px;
        }
        .dashboard-container {
            display: none;
        }
        .sidebar {
            width: 250px;
            transition: all 0.3s;
        }
        .main-content {
            margin-left: 250px;
            transition: all 0.3s;
        }
        .sidebar-collapsed {
            width: 70px;
        }
        .main-content-collapsed {
            margin-left: 70px;
        }
        .menu-item {
            transition: all 0.2s;
        }
        .menu-item.active {
            background-color: #3b82f6;
            color: white;
        }
        .page-section {
            display: none;
        }
        .page-section.active {
            display: block;
        }
        .editor-toolbar {
            border: 1px solid #ddd;
            border-bottom: 0;
            padding: 5px;
            border-radius: 5px 5px 0 0;
        }
        .editor-content {
            border: 1px solid #ddd;
            min-height: 300px;
            padding: 15px;
            border-radius: 0 0 5px 5px;
            outline: none;
        }
        .image-preview {
            max-width: 200px;
            max-height: 200px;
            margin-top: 10px;
            display: none;
        }
    </style>
</head>
<body class="bg-gray-100">
    <!-- Login Screen -->
    <div id="loginScreen" class="login-container">
        <div class="login-box">
            <div class="text-center mb-8">
                <img src="media/photos/1768200744316.jpg" alt="Logo" class="w-16 h-16 rounded-full mx-auto mb-4">
                <h1 class="text-2xl font-bold text-gray-800">Jehovah Jire Dashboard</h1>
                <p class="text-gray-600 mt-2">Please sign in to continue</p>
            </div>

            <form id="loginForm">
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-medium mb-2" for="username">
                        Username
                    </label>
                    <input class="shadow appearance-none border rounded w-full py-3 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="username" type="text" placeholder="Enter username">
                </div>

                <div class="mb-6">
                    <label class="block text-gray-700 text-sm font-medium mb-2" for="password">
                        Password
                    </label>
                    <input class="shadow appearance-none border rounded w-full py-3 px-3 text-gray-700 mb-3 leading-tight focus:outline-none focus:shadow-outline" id="password" type="password" placeholder="Enter password">
                </div>

                <div class="flex items-center justify-between">
                    <button type="submit" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded focus:outline-none focus:shadow-outline">
                        Sign In
                    </button>
                </div>

                <div id="loginError" class="hidden mt-4 p-3 bg-red-100 text-red-700 rounded text-sm"></div>
            </form>
        </div>
    </div>

    <!-- Dashboard -->
    <div id="dashboardContainer" class="dashboard-container">
        <!-- Sidebar -->
        <div id="sidebar" class="sidebar fixed top-0 left-0 h-screen bg-gray-800 text-white z-50 flex flex-col">
            <div class="p-5 border-b border-gray-700">
                <h1 class="text-xl font-bold flex items-center">
                    <img src="media/photos/1768200744316.jpg" alt="Logo" class="w-8 h-8 rounded-full mr-2">
                    <span class="sidebar-text">Jehovah Jire Dashboard</span>
                </h1>
            </div>
            <ul class="flex-1 py-4">
                <li>
                    <a href="#" class="menu-item active flex items-center p-4 hover:bg-gray-700">
                        <i class="fas fa-home mr-3"></i>
                        <span class="sidebar-text">Home Content</span>
                    </a>
                </li>
                <li>
                    <a href="#" class="menu-item flex items-center p-4 hover:bg-gray-700">
                        <i class="fas fa-info-circle mr-3"></i>
                        <span class="sidebar-text">About Page</span>
                    </a>
                </li>
                <li>
                    <a href="#" class="menu-item flex items-center p-4 hover:bg-gray-700">
                        <i class="fas fa-bullseye mr-3"></i>
                        <span class="sidebar-text">Missions Page</span>
                    </a>
                </li>
                <li>
                    <a href="#" class="menu-item flex items-center p-4 hover:bg-gray-700">
                        <i class="fas fa-users mr-3"></i>
                        <span class="sidebar-text">Team Page</span>
                    </a>
                </li>
                <li>
                    <a href="#" class="menu-item flex items-center p-4 hover:bg-gray-700">
                        <i class="fas fa-images mr-3"></i>
                        <span class="sidebar-text">Gallery</span>
                    </a>
                </li>
                <li>
                    <a href="#" class="menu-item flex items-center p-4 hover:bg-gray-700">
                        <i class="fas fa-address-book mr-3"></i>
                        <span class="sidebar-text">Contact Page</span>
                    </a>
                </li>
                <li>
                    <a href="#" class="menu-item flex items-center p-4 hover:bg-gray-700">
                        <i class="fas fa-blog mr-3"></i>
                        <span class="sidebar-text">Blog Posts</span>
                    </a>
                </li>
                <li>
                    <a href="#" class="menu-item flex items-center p-4 hover:bg-gray-700">
                        <i class="fas fa-comments mr-3"></i>
                        <span class="sidebar-text">Testimonials</span>
                    </a>
                </li>
            </ul>
            <div class="p-4 border-t border-gray-700">
                <button id="toggleSidebar" class="w-full bg-gray-700 hover:bg-gray-600 py-2 rounded flex items-center justify-center">
                    <i class="fas fa-arrows-alt-h"></i>
                    <span class="sidebar-text ml-2">Collapse</span>
                </button>
                <button id="logoutBtn" class="w-full mt-2 bg-red-600 hover:bg-red-700 py-2 rounded flex items-center justify-center">
                    <i class="fas fa-sign-out-alt mr-2"></i>
                    <span>Logout</span>
                </button>
            </div>
        </div>

        <!-- Main Content -->
        <div id="mainContent" class="main-content">
            <!-- Top Navigation -->
            <nav class="bg-white shadow-md">
                <div class="px-6 py-4 flex justify-between items-center">
                    <h2 id="pageTitle" class="text-xl font-semibold text-gray-800">Home Content</h2>
                    <div class="flex items-center space-x-4">
                        <span class="text-gray-600">Welcome, Administrator</span>
                        <button id="saveChanges" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded flex items-center">
                            <i class="fas fa-save mr-2"></i> Save Changes
                        </button>
                    </div>
                </div>
            </nav>

        <!-- Page Content Sections -->
        <div class="p-6">
            <!-- Home Content Section -->
            <div id="homeContent" class="page-section active">
                <div class="bg-white rounded-lg shadow p-6 mb-6">
                    <h3 class="text-lg font-semibold mb-4 text-blue-700">Hero Section</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-gray-700 mb-2">Hero Title</label>
                            <input type="text" id="heroTitle" class="w-full px-4 py-2 border rounded-lg" value="Jehovah Jire Ministry">
                        </div>
                        <div>
                            <label class="block text-gray-700 mb-2">Hero Subtitle</label>
                            <textarea id="heroSubtitle" class="w-full px-4 py-2 border rounded-lg" rows="3">Led by the Holy Spirit, serving the needs of widows and orphans by sharing God's love, hope, and Word</textarea>
                        </div>
                    </div>
                </div>

                <div class="bg-white rounded-lg shadow p-6 mb-6">
                    <h3 class="text-lg font-semibold mb-4 text-blue-700">Vision Section</h3>
                    <div class="mb-4">
                        <label class="block text-gray-700 mb-2">Vision Statement</label>
                        <textarea id="visionText" class="w-full px-4 py-2 border rounded-lg" rows="4">Our vision is to restore hope and dignity to the most vulnerable members of society through the compassionate provision of God's love. We envision a world where widows and orphans experience security, love, and opportunity through our ministry's dedicated service.</textarea>
                    </div>
                </div>

                <div class="bg-white rounded-lg shadow p-6 mb-6">
                    <h3 class="text-lg font-semibold mb-4 text-blue-700">Mission Section</h3>
                    <div class="mb-4">
                        <label class="block text-gray-700 mb-2">Mission Statement</label>
                        <textarea id="missionText" class="w-full px-4 py-2 border rounded-lg" rows="4">Our mission is to demonstrate God's unconditional love by providing holistic care, compassion, and empowerment to widows and orphans. Through our dedicated service, we aim to meet both physical and spiritual needs, offering sustainable solutions that honor God and transform lives.</textarea>
                    </div>
                </div>

                <div class="bg-white rounded-lg shadow p-6">
                    <h3 class="text-lg font-semibold mb-4 text-blue-700">Purpose Section</h3>
                    <div class="mb-4">
                        <label class="block text-gray-700 mb-2">Purpose Statement</label>
                        <textarea id="purposeText" class="w-full px-4 py-2 border rounded-lg" rows="4">Our purpose is to serve God by caring for the most vulnerable members of society. Guided by the Holy Spirit, we are committed to addressing the critical needs of widows and orphans, providing them with resources, support, and spiritual guidance that reflect the heart of God.</textarea>
                    </div>
                </div>
            </div>

            <!-- About Page Section -->
            <div id="aboutPage" class="page-section">
                <div class="bg-white rounded-lg shadow p-6">
                    <h3 class="text-lg font-semibold mb-4 text-blue-700">About Page Content</h3>
                    <div class="mb-4">
                        <label class="block text-gray-700 mb-2">Page Title</label>
                        <input type="text" id="aboutTitle" class="w-full px-4 py-2 border rounded-lg" value="About Our Ministry">
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 mb-2">Introduction</label>
                        <textarea id="aboutIntro" class="w-full px-4 py-2 border rounded-lg" rows="4">Learn more about our ministry's calling and commitment to serving the most vulnerable members of society with love, compassion, and practical support.</textarea>
                    </div>
                </div>
            </div>

            <!-- Missions Page Section -->
            <div id="missionsPage" class="page-section">
                <div class="bg-white rounded-lg shadow p-6">
                    <h3 class="text-lg font-semibold mb-4 text-blue-700">Missions Page Content</h3>
                    <div class="mb-4">
                        <label class="block text-gray-700 mb-2">Page Title</label>
                        <input type="text" id="missionsTitle" class="w-full px-4 py-2 border rounded-lg" value="Our Missions">
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 mb-2">Introduction</label>
                        <textarea id="missionsIntro" class="w-full px-4 py-2 border rounded-lg" rows="4">We are called to serve the most vulnerable members of society with love, compassion, and practical support.</textarea>
                    </div>
                </div>
            </div>

            <!-- Team Page Section -->
            <div id="teamPage" class="page-section">
                <div class="bg-white rounded-lg shadow p-6">
                    <h3 class="text-lg font-semibold mb-4 text-blue-700">Team Management</h3>
                    <div class="mb-6">
                        <h4 class="font-medium mb-3">Add New Team Member</h4>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                            <div>
                                <label class="block text-gray-700 mb-2">Name</label>
                                <input type="text" id="teamMemberName" class="w-full px-4 py-2 border rounded-lg">
                            </div>
                            <div>
                                <label class="block text-gray-700 mb-2">Position</label>
                                <input type="text" id="teamMemberPosition" class="w-full px-4 py-2 border rounded-lg">
                            </div>
                            <div>
                                <label class="block text-gray-700 mb-2">Image URL</label>
                                <input type="text" id="teamMemberImage" class="w-full px-4 py-2 border rounded-lg">
                            </div>
                        </div>
                        <button id="addTeamMember" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded flex items-center">
                            <i class="fas fa-plus mr-2"></i> Add Team Member
                        </button>
                    </div>
                    
                    <div>
                        <h4 class="font-medium mb-3">Current Team Members</h4>
                        <div id="teamMembersList" class="overflow-x-auto">
                            <table class="min-w-full divide-y divide-gray-200">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Name</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Position</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="teamMembersTableBody" class="bg-white divide-y divide-gray-200">
                                    <!-- Team members will be populated here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Gallery Section -->
            <div id="gallerySection" class="page-section">
                <div class="bg-white rounded-lg shadow p-6">
                    <h3 class="text-lg font-semibold mb-4 text-blue-700">Gallery Management</h3>
                    <div class="mb-6">
                        <h4 class="font-medium mb-3">Add New Gallery Item</h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                            <div>
                                <label class="block text-gray-700 mb-2">Image URL</label>
                                <input type="text" id="galleryImageUrl" class="w-full px-4 py-2 border rounded-lg">
                            </div>
                            <div>
                                <label class="block text-gray-700 mb-2">Caption</label>
                                <input type="text" id="galleryCaption" class="w-full px-4 py-2 border rounded-lg">
                            </div>
                        </div>
                        <button id="addGalleryItem" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded flex items-center">
                            <i class="fas fa-plus mr-2"></i> Add Gallery Item
                        </button>
                    </div>
                    
                    <div>
                        <h4 class="font-medium mb-3">Current Gallery Items</h4>
                        <div id="galleryItemsList" class="grid grid-cols-2 md:grid-cols-4 gap-4">
                            <!-- Gallery items will be populated here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Blog Posts Section -->
            <div id="blogPosts" class="page-section">
                <div class="bg-white rounded-lg shadow p-6">
                    <h3 class="text-lg font-semibold mb-4 text-blue-700">Blog Posts Management</h3>
                    <div class="mb-6">
                        <h4 class="font-medium mb-3">Create New Post</h4>
                        <div class="mb-4">
                            <label class="block text-gray-700 mb-2">Post Title</label>
                            <input type="text" id="postTitle" class="w-full px-4 py-2 border rounded-lg">
                        </div>
                        <div class="mb-4">
                            <label class="block text-gray-700 mb-2">Post Category</label>
                            <select id="postCategory" class="w-full px-4 py-2 border rounded-lg">
                                <option value="announcement">Announcement</option>
                                <option value="event">Event</option>
                                <option value="testimony">Testimony</option>
                                <option value="news">News</option>
                            </select>
                        </div>
                        <div class="mb-4">
                            <label class="block text-gray-700 mb-2">Post Content</label>
                            <div class="editor-toolbar">
                                <button type="button" class="toolbar-btn" data-command="bold"><i class="fas fa-bold"></i></button>
                                <button type="button" class="toolbar-btn" data-command="italic"><i class="fas fa-italic"></i></button>
                                <button type="button" class="toolbar-btn" data-command="insertUnorderedList"><i class="fas fa-list-ul"></i></button>
                                <button type="button" class="toolbar-btn" data-command="insertOrderedList"><i class="fas fa-list-ol"></i></button>
                            </div>
                            <div id="postContent" class="editor-content" contenteditable="true"></div>
                        </div>
                        <button id="publishPost" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded flex items-center">
                            <i class="fas fa-paper-plane mr-2"></i> Publish Post
                        </button>
                    </div>
                    
                    <div>
                        <h4 class="font-medium mb-3">Recent Posts</h4>
                        <div id="postsList" class="space-y-4">
                            <!-- Posts will be populated here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Testimonials Section -->
            <div id="testimonialsSection" class="page-section">
                <div class="bg-white rounded-lg shadow p-6">
                    <h3 class="text-lg font-semibold mb-4 text-blue-700">Testimonials Management</h3>
                    <div class="mb-6">
                        <h4 class="font-medium mb-3">Add New Testimonial</h4>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                            <div>
                                <label class="block text-gray-700 mb-2">Name</label>
                                <input type="text" id="testimonialName" class="w-full px-4 py-2 border rounded-lg">
                            </div>
                            <div>
                                <label class="block text-gray-700 mb-2">Role</label>
                                <input type="text" id="testimonialRole" class="w-full px-4 py-2 border rounded-lg">
                            </div>
                            <div>
                                <label class="block text-gray-700 mb-2">Rating</label>
                                <select id="testimonialRating" class="w-full px-4 py-2 border rounded-lg">
                                    <option value="5">5 Stars</option>
                                    <option value="4">4 Stars</option>
                                    <option value="3">3 Stars</option>
                                    <option value="2">2 Stars</option>
                                    <option value="1">1 Star</option>
                                </select>
                            </div>
                        </div>
                        <div class="mb-4">
                            <label class="block text-gray-700 mb-2">Testimonial Content</label>
                            <textarea id="testimonialContent" class="w-full px-4 py-2 border rounded-lg" rows="4"></textarea>
                        </div>
                        <button id="addTestimonial" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded flex items-center">
                            <i class="fas fa-plus mr-2"></i> Add Testimonial
                        </button>
                    </div>
                    
                    <div>
                        <h4 class="font-medium mb-3">Current Testimonials</h4>
                        <div id="testimonialsList" class="space-y-4">
                            <!-- Testimonials will be populated here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script>
        // DOM Elements
        const sidebar = document.getElementById('sidebar');
        const mainContent = document.getElementById('mainContent');
        const toggleSidebar = document.getElementById('toggleSidebar');
        const menuItems = document.querySelectorAll('.menu-item');
        const pageSections = document.querySelectorAll('.page-section');
        const pageTitle = document.getElementById('pageTitle');
        const saveChangesBtn = document.getElementById('saveChanges');
        
        // Sample data for demonstration
        let teamMembers = [
            { name: "Aimeciane Wembakoy Dorcas", position: "Coordinator", image: "media/photos/coordinator.png" },
            { name: "Byaombe Mshikongwe", position: "Vice Coordinator", image: "media/photos/vice _president.jpeg" },
            { name: "Cambasita Miriam Sarahi", position: "Secretary", image: "media/photos/secre.jpeg" },
            { name: "Nyota Christine", position: "Treasurer", image: "media/photos/tressure.jpeg" }
        ];
        
        let galleryItems = [
            { url: "media/photos/1768200744111.jpg", caption: "Ministry Outreach" },
            { url: "media/photos/1768200744123.jpg", caption: "Community Service" },
            { url: "media/photos/1768200744137.jpg", caption: "Feeding Program" },
            { url: "media/photos/1768200744159.jpg", caption: "Educational Support" }
        ];
        
        let blogPosts = [
            { title: "Feeding Program Success", category: "event", content: "Our recent feeding program helped 200 families in need." },
            { title: "New Education Initiative", category: "announcement", content: "We've launched a scholarship program for 50 underprivileged children." }
        ];
        
        let testimonials = [
            { name: "Grace M.", role: "Beneficiary", content: "Jehovah Jire Ministry changed my life when I had lost all hope. Through their food program, I was able to feed my children when I had no means. Their spiritual guidance gave me strength to persevere.", rating: 5 },
            { name: "Michael T.", role: "Widow Support Recipient", content: "After my husband passed away, I didn't know how I would support my family. Jehovah Jire Ministry provided not just material help, but emotional and spiritual support that helped me rebuild my life.", rating: 5 }
        ];

        // Toggle sidebar
        toggleSidebar.addEventListener('click', () => {
            sidebar.classList.toggle('sidebar-collapsed');
            mainContent.classList.toggle('main-content-collapsed');
            
            const isCollapsed = sidebar.classList.contains('sidebar-collapsed');
            document.querySelectorAll('.sidebar-text').forEach(el => {
                el.style.display = isCollapsed ? 'none' : 'inline';
            });
            
            toggleSidebar.innerHTML = isCollapsed ? 
                '<i class="fas fa-arrows-alt-h"></i>' : 
                '<i class="fas fa-arrows-alt-h"></i> <span class="sidebar-text ml-2">Collapse</span>';
        });

        // Menu navigation
        menuItems.forEach(item => {
            item.addEventListener('click', (e) => {
                e.preventDefault();
                
                // Update active menu item
                menuItems.forEach(i => i.classList.remove('active'));
                item.classList.add('active');
                
                // Show corresponding section
                const target = item.querySelector('span').textContent;
                pageSections.forEach(section => section.classList.remove('active'));
                
                let sectionId = '';
                switch(target) {
                    case 'Home Content':
                        sectionId = 'homeContent';
                        pageTitle.textContent = 'Home Content';
                        break;
                    case 'About Page':
                        sectionId = 'aboutPage';
                        pageTitle.textContent = 'About Page';
                        break;
                    case 'Missions Page':
                        sectionId = 'missionsPage';
                        pageTitle.textContent = 'Missions Page';
                        break;
                    case 'Team Page':
                        sectionId = 'teamPage';
                        pageTitle.textContent = 'Team Management';
                        break;
                    case 'Gallery':
                        sectionId = 'gallerySection';
                        pageTitle.textContent = 'Gallery Management';
                        break;
                    case 'Blog Posts':
                        sectionId = 'blogPosts';
                        pageTitle.textContent = 'Blog Posts';
                        break;
                    case 'Testimonials':
                        sectionId = 'testimonialsSection';
                        pageTitle.textContent = 'Testimonials';
                        break;
                    case 'Contact Page':
                        sectionId = 'contactPage';
                        pageTitle.textContent = 'Contact Page';
                        break;
                }
                
                if(sectionId) {
                    document.getElementById(sectionId).classList.add('active');
                }
            });
        });

        // Save changes function
        saveChangesBtn.addEventListener('click', () => {
            // Save all content to localStorage
            const contentData = {
                heroTitle: document.getElementById('heroTitle').value,
                heroSubtitle: document.getElementById('heroSubtitle').value,
                visionText: document.getElementById('visionText').value,
                missionText: document.getElementById('missionText').value,
                purposeText: document.getElementById('purposeText').value,
                aboutTitle: document.getElementById('aboutTitle').value,
                aboutIntro: document.getElementById('aboutIntro').value,
                missionsTitle: document.getElementById('missionsTitle').value,
                missionsIntro: document.getElementById('missionsIntro').value,
                teamMembers: teamMembers,
                galleryItems: galleryItems,
                blogPosts: blogPosts,
                testimonials: testimonials
            };

            localStorage.setItem('cmsContentData', JSON.stringify(contentData));

            // Update live website content if windows are open
            updateLiveWebsite(contentData);

            alert('Changes saved successfully!');
        });

        // Update live website content function
        function updateLiveWebsite(contentData) {
            // Update hero section if homepage is open
            if(window.opener && !window.opener.closed) {
                try {
                    const openerDoc = window.opener.document;
                    if(openerDoc.querySelector('#home h1')) {
                        openerDoc.querySelector('#home h1').textContent = contentData.heroTitle;
                    }
                    if(openerDoc.querySelector('#home .max-w-3xl.mx-auto')) {
                        openerDoc.querySelector('#home .max-w-3xl.mx-auto').textContent = contentData.heroSubtitle;
                    }
                    if(openerDoc.querySelector('#about .bg-gray-50 p.text-center')) {
                        openerDoc.querySelector('#about .bg-gray-50 p.text-center').textContent = contentData.visionText;
                    }
                } catch(e) {
                    // Ignore cross-origin errors
                }
            }

            // Update current window if it's the website
            if(document.querySelector('#home h1')) {
                document.querySelector('#home h1').textContent = contentData.heroTitle;
            }
            if(document.querySelector('#home .max-w-3xl.mx-auto')) {
                document.querySelector('#home .max-w-3xl.mx-auto').textContent = contentData.heroSubtitle;
            }
            if(document.querySelector('#about .bg-gray-50 p.text-center')) {
                document.querySelector('#about .bg-gray-50 p.text-center').textContent = contentData.visionText;
            }
        }


        // Load saved content on page load
        window.addEventListener('DOMContentLoaded', () => {
            const savedData = localStorage.getItem('cmsContentData');
            if(savedData) {
                const data = JSON.parse(savedData);

                // Populate form fields with saved data
                if(data.heroTitle) document.getElementById('heroTitle').value = data.heroTitle;
                if(data.heroSubtitle) document.getElementById('heroSubtitle').value = data.heroSubtitle;
                if(data.visionText) document.getElementById('visionText').value = data.visionText;
                if(data.missionText) document.getElementById('missionText').value = data.missionText;
                if(data.purposeText) document.getElementById('purposeText').value = data.purposeText;
                if(data.aboutTitle) document.getElementById('aboutTitle').value = data.aboutTitle;
                if(data.aboutIntro) document.getElementById('aboutIntro').value = data.aboutIntro;
                if(data.missionsTitle) document.getElementById('missionsTitle').value = data.missionsTitle;
                if(data.missionsIntro) document.getElementById('missionsIntro').value = data.missionsIntro;

                // Reload data arrays if they exist
                if(data.teamMembers) teamMembers = data.teamMembers;
                if(data.galleryItems) galleryItems = data.galleryItems;
                if(data.blogPosts) blogPosts = data.blogPosts;
                if(data.testimonials) testimonials = data.testimonials;
            }

            // Populate team members table
            renderTeamMembers();

            // Populate gallery items
            renderGalleryItems();

            // Populate blog posts
            renderBlogPosts();

            // Populate testimonials
            renderTestimonials();

            // Add event listener to automatically save changes as they happen
            setupAutoSave();
        });

        // Setup auto-save functionality
        function setupAutoSave() {
            // Add input event listeners to save changes automatically
            document.getElementById('heroTitle').addEventListener('input', debounce(autoSave, 1000));
            document.getElementById('heroSubtitle').addEventListener('input', debounce(autoSave, 1000));
            document.getElementById('visionText').addEventListener('input', debounce(autoSave, 1000));
            document.getElementById('missionText').addEventListener('input', debounce(autoSave, 1000));
            document.getElementById('purposeText').addEventListener('input', debounce(autoSave, 1000));
        }

        // Auto-save function
        function autoSave() {
            const contentData = {
                heroTitle: document.getElementById('heroTitle').value,
                heroSubtitle: document.getElementById('heroSubtitle').value,
                visionText: document.getElementById('visionText').value,
                missionText: document.getElementById('missionText').value,
                purposeText: document.getElementById('purposeText').value,
                aboutTitle: document.getElementById('aboutTitle').value,
                aboutIntro: document.getElementById('aboutIntro').value,
                missionsTitle: document.getElementById('missionsTitle').value,
                missionsIntro: document.getElementById('missionsIntro').value,
                teamMembers: teamMembers,
                galleryItems: galleryItems,
                blogPosts: blogPosts,
                testimonials: testimonials
            };

            localStorage.setItem('cmsContentData', JSON.stringify(contentData));

            // Update live website content
            updateLiveWebsite(contentData);
        }

        // Debounce function to limit how often a function can run
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        // Team member management
        document.getElementById('addTeamMember').addEventListener('click', () => {
            const name = document.getElementById('teamMemberName').value;
            const position = document.getElementById('teamMemberPosition').value;
            const image = document.getElementById('teamMemberImage').value;

            if(name && position) {
                teamMembers.push({ name, position, image: image || 'media/photos/default.jpg' });
                renderTeamMembers();

                // Save to localStorage and update website
                saveAndRefresh();

                // Clear form
                document.getElementById('teamMemberName').value = '';
                document.getElementById('teamMemberPosition').value = '';
                document.getElementById('teamMemberImage').value = '';
            } else {
                alert('Please fill in at least the name and position fields.');
            }
        });

        function renderTeamMembers() {
            const tbody = document.getElementById('teamMembersTableBody');
            tbody.innerHTML = '';

            teamMembers.forEach((member, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap">${member.name}</td>
                    <td class="px-6 py-4 whitespace-nowrap">${member.position}</td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <button onclick="editTeamMember(${index})" class="text-blue-600 hover:text-blue-900 mr-3">Edit</button>
                        <button onclick="deleteTeamMember(${index})" class="text-red-600 hover:text-red-900">Delete</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        // Save and refresh function
        function saveAndRefresh() {
            const contentData = {
                heroTitle: document.getElementById('heroTitle').value,
                heroSubtitle: document.getElementById('heroSubtitle').value,
                visionText: document.getElementById('visionText').value,
                missionText: document.getElementById('missionText').value,
                purposeText: document.getElementById('purposeText').value,
                aboutTitle: document.getElementById('aboutTitle').value,
                aboutIntro: document.getElementById('aboutIntro').value,
                missionsTitle: document.getElementById('missionsTitle').value,
                missionsIntro: document.getElementById('missionsIntro').value,
                teamMembers: teamMembers,
                galleryItems: galleryItems,
                blogPosts: blogPosts,
                testimonials: testimonials
            };

            localStorage.setItem('cmsContentData', JSON.stringify(contentData));

            // Update live website content
            updateLiveWebsite(contentData);
        }

        window.editTeamMember = function(index) {
            const member = teamMembers[index];
            document.getElementById('teamMemberName').value = member.name;
            document.getElementById('teamMemberPosition').value = member.position;
            document.getElementById('teamMemberImage').value = member.image;

            // Change button to update
            const addButton = document.getElementById('addTeamMember');
            addButton.textContent = 'Update Team Member';
            addButton.onclick = function() {
                member.name = document.getElementById('teamMemberName').value;
                member.position = document.getElementById('teamMemberPosition').value;
                member.image = document.getElementById('teamMemberImage').value || 'media/photos/default.jpg';

                renderTeamMembers();

                // Save and refresh
                saveAndRefresh();

                // Reset form and button
                document.getElementById('teamMemberName').value = '';
                document.getElementById('teamMemberPosition').value = '';
                document.getElementById('teamMemberImage').value = '';
                addButton.textContent = 'Add Team Member';
                addButton.onclick = function() {
                    const name = document.getElementById('teamMemberName').value;
                    const position = document.getElementById('teamMemberPosition').value;
                    const image = document.getElementById('teamMemberImage').value;

                    if(name && position) {
                        teamMembers.push({ name, position, image: image || 'media/photos/default.jpg' });
                        renderTeamMembers();

                        // Save and refresh
                        saveAndRefresh();

                        document.getElementById('teamMemberName').value = '';
                        document.getElementById('teamMemberPosition').value = '';
                        document.getElementById('teamMemberImage').value = '';
                    } else {
                        alert('Please fill in at least the name and position fields.');
                    }
                };
            };
        };

        window.deleteTeamMember = function(index) {
            if(confirm(`Are you sure you want to remove ${teamMembers[index].name} from the team list?`)) {
                teamMembers.splice(index, 1);
                renderTeamMembers();

                // Save and refresh
                saveAndRefresh();
            }
        };

        // Gallery management
        document.getElementById('addGalleryItem').addEventListener('click', () => {
            const url = document.getElementById('galleryImageUrl').value;
            const caption = document.getElementById('galleryCaption').value;

            if(url && caption) {
                galleryItems.push({ url, caption });
                renderGalleryItems();

                // Save to localStorage and update website
                saveAndRefresh();

                // Clear form
                document.getElementById('galleryImageUrl').value = '';
                document.getElementById('galleryCaption').value = '';
            } else {
                alert('Please fill in both the image URL and caption fields.');
            }
        });

        function renderGalleryItems() {
            const container = document.getElementById('galleryItemsList');
            container.innerHTML = '';

            galleryItems.forEach((item, index) => {
                const div = document.createElement('div');
                div.className = 'border rounded p-2';
                div.innerHTML = `
                    <img src="${item.url}" alt="${item.caption}" class="w-full h-32 object-cover rounded mb-2">
                    <p class="text-sm truncate">${item.caption}</p>
                    <div class="mt-2 flex justify-between">
                        <button onclick="editGalleryItem(${index})" class="text-blue-600 hover:text-blue-900 text-xs">Edit</button>
                        <button onclick="deleteGalleryItem(${index})" class="text-red-600 hover:text-red-900 text-xs">Delete</button>
                    </div>
                `;
                container.appendChild(div);
            });
        }

        window.editGalleryItem = function(index) {
            const item = galleryItems[index];
            document.getElementById('galleryImageUrl').value = item.url;
            document.getElementById('galleryCaption').value = item.caption;

            // Change button to update
            const addButton = document.getElementById('addGalleryItem');
            addButton.textContent = 'Update Gallery Item';
            addButton.onclick = function() {
                item.url = document.getElementById('galleryImageUrl').value;
                item.caption = document.getElementById('galleryCaption').value;

                renderGalleryItems();

                // Save and refresh
                saveAndRefresh();

                // Reset form and button
                document.getElementById('galleryImageUrl').value = '';
                document.getElementById('galleryCaption').value = '';
                addButton.textContent = 'Add Gallery Item';
                addButton.onclick = function() {
                    const url = document.getElementById('galleryImageUrl').value;
                    const caption = document.getElementById('galleryCaption').value;

                    if(url && caption) {
                        galleryItems.push({ url, caption });
                        renderGalleryItems();

                        // Save and refresh
                        saveAndRefresh();

                        document.getElementById('galleryImageUrl').value = '';
                        document.getElementById('galleryCaption').value = '';
                    } else {
                        alert('Please fill in both the image URL and caption fields.');
                    }
                };
            };
        };

        window.deleteGalleryItem = function(index) {
            if(confirm(`Are you sure you want to remove this gallery item?`)) {
                galleryItems.splice(index, 1);
                renderGalleryItems();

                // Save and refresh
                saveAndRefresh();
            }
        };

        // Blog post management
        document.getElementById('publishPost').addEventListener('click', () => {
            const title = document.getElementById('postTitle').value;
            const category = document.getElementById('postCategory').value;
            const content = document.getElementById('postContent').innerHTML;

            if(title && content) {
                blogPosts.unshift({ title, category, content });
                renderBlogPosts();

                // Save to localStorage and update website
                saveAndRefresh();

                // Clear form
                document.getElementById('postTitle').value = '';
                document.getElementById('postCategory').value = 'announcement';
                document.getElementById('postContent').innerHTML = '';
            } else {
                alert('Please fill in both the title and content fields.');
            }
        });

        function renderBlogPosts() {
            const container = document.getElementById('postsList');
            container.innerHTML = '';

            blogPosts.forEach((post, index) => {
                const div = document.createElement('div');
                div.className = 'border rounded p-4 mb-4';
                div.innerHTML = `
                    <h4 class="font-bold text-lg">${post.title}</h4>
                    <p class="text-sm text-gray-600 mb-2">Category: ${post.category}</p>
                    <div class="mb-3">${post.content.substring(0, 150)}${post.content.length > 150 ? '...' : ''}</div>
                    <div class="flex justify-between">
                        <button onclick="editBlogPost(${index})" class="text-blue-600 hover:text-blue-900 text-sm">Edit</button>
                        <button onclick="deleteBlogPost(${index})" class="text-red-600 hover:text-red-900 text-sm">Delete</button>
                    </div>
                `;
                container.appendChild(div);
            });
        }

        window.editBlogPost = function(index) {
            const post = blogPosts[index];
            document.getElementById('postTitle').value = post.title;
            document.getElementById('postCategory').value = post.category;
            document.getElementById('postContent').innerHTML = post.content;

            // Change button to update
            const publishButton = document.getElementById('publishPost');
            publishButton.textContent = 'Update Post';
            publishButton.onclick = function() {
                post.title = document.getElementById('postTitle').value;
                post.category = document.getElementById('postCategory').value;
                post.content = document.getElementById('postContent').innerHTML;

                renderBlogPosts();

                // Save and refresh
                saveAndRefresh();

                // Reset form and button
                document.getElementById('postTitle').value = '';
                document.getElementById('postCategory').value = 'announcement';
                document.getElementById('postContent').innerHTML = '';
                publishButton.textContent = 'Publish Post';
                publishButton.onclick = function() {
                    const title = document.getElementById('postTitle').value;
                    const category = document.getElementById('postCategory').value;
                    const content = document.getElementById('postContent').innerHTML;

                    if(title && content) {
                        blogPosts.unshift({ title, category, content });
                        renderBlogPosts();

                        // Save and refresh
                        saveAndRefresh();

                        document.getElementById('postTitle').value = '';
                        document.getElementById('postCategory').value = 'announcement';
                        document.getElementById('postContent').innerHTML = '';
                    } else {
                        alert('Please fill in both the title and content fields.');
                    }
                };
            };
        };

        window.deleteBlogPost = function(index) {
            if(confirm(`Are you sure you want to delete the post "${blogPosts[index].title}"?`)) {
                blogPosts.splice(index, 1);
                renderBlogPosts();

                // Save and refresh
                saveAndRefresh();
            }
        };

        // Testimonial management
        document.getElementById('addTestimonial').addEventListener('click', () => {
            const name = document.getElementById('testimonialName').value;
            const role = document.getElementById('testimonialRole').value;
            const content = document.getElementById('testimonialContent').value;
            const rating = document.getElementById('testimonialRating').value;

            if(name && role && content) {
                testimonials.unshift({ name, role, content, rating: parseInt(rating) });
                renderTestimonials();

                // Save to localStorage and update website
                saveAndRefresh();

                // Clear form
                document.getElementById('testimonialName').value = '';
                document.getElementById('testimonialRole').value = '';
                document.getElementById('testimonialContent').value = '';
                document.getElementById('testimonialRating').value = '5';
            } else {
                alert('Please fill in the name, role, and content fields.');
            }
        });

        function renderTestimonials() {
            const container = document.getElementById('testimonialsList');
            container.innerHTML = '';

            testimonials.forEach((testimonial, index) => {
                const div = document.createElement('div');
                div.className = 'border rounded p-4 mb-4';
                div.innerHTML = `
                    <div class="flex items-center mb-2">
                        <h4 class="font-bold">${testimonial.name}</h4>
                        <span class="ml-2 text-sm text-blue-600">${testimonial.role}</span>
                    </div>
                    <p class="mb-2">"${testimonial.content}"</p>
                    <div class="flex text-yellow-400 mb-3">
                        ${'<i class="fas fa-star"></i>'.repeat(testimonial.rating)}
                        ${'<i class="far fa-star"></i>'.repeat(5 - testimonial.rating)}
                    </div>
                    <div class="flex justify-between">
                        <button onclick="editTestimonial(${index})" class="text-blue-600 hover:text-blue-900 text-sm">Edit</button>
                        <button onclick="deleteTestimonial(${index})" class="text-red-600 hover:text-red-900 text-sm">Delete</button>
                    </div>
                `;
                container.appendChild(div);
            });
        }

        window.editTestimonial = function(index) {
            const testimonial = testimonials[index];
            document.getElementById('testimonialName').value = testimonial.name;
            document.getElementById('testimonialRole').value = testimonial.role;
            document.getElementById('testimonialContent').value = testimonial.content;
            document.getElementById('testimonialRating').value = testimonial.rating;

            // Change button to update
            const addButton = document.getElementById('addTestimonial');
            addButton.textContent = 'Update Testimonial';
            addButton.onclick = function() {
                testimonial.name = document.getElementById('testimonialName').value;
                testimonial.role = document.getElementById('testimonialRole').value;
                testimonial.content = document.getElementById('testimonialContent').value;
                testimonial.rating = document.getElementById('testimonialRating').value;

                renderTestimonials();

                // Save and refresh
                saveAndRefresh();

                // Reset form and button
                document.getElementById('testimonialName').value = '';
                document.getElementById('testimonialRole').value = '';
                document.getElementById('testimonialContent').value = '';
                document.getElementById('testimonialRating').value = '5';
                addButton.textContent = 'Add Testimonial';
                addButton.onclick = function() {
                    const name = document.getElementById('testimonialName').value;
                    const role = document.getElementById('testimonialRole').value;
                    const content = document.getElementById('testimonialContent').value;
                    const rating = document.getElementById('testimonialRating').value;

                    if(name && role && content) {
                        testimonials.unshift({ name, role, content, rating: parseInt(rating) });
                        renderTestimonials();

                        // Save and refresh
                        saveAndRefresh();

                        document.getElementById('testimonialName').value = '';
                        document.getElementById('testimonialRole').value = '';
                        document.getElementById('testimonialContent').value = '';
                        document.getElementById('testimonialRating').value = '5';
                    } else {
                        alert('Please fill in the name, role, and content fields.');
                    }
                };
            };
        };

        window.deleteTestimonial = function(index) {
            if(confirm(`Are you sure you want to delete the testimonial from "${testimonials[index].name}"?`)) {
                testimonials.splice(index, 1);
                renderTestimonials();

                // Save and refresh
                saveAndRefresh();
            }
        };

        // Toolbar functionality for content editor
        document.querySelectorAll('.toolbar-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const command = this.getAttribute('data-command');
                document.execCommand(command, false, null);
                document.getElementById('postContent').focus();
            });
        });

        // Authentication functionality
        const loginScreen = document.getElementById('loginScreen');
        const dashboardContainer = document.getElementById('dashboardContainer');
        const loginForm = document.getElementById('loginForm');
        const loginError = document.getElementById('loginError');
        const logoutBtn = document.getElementById('logoutBtn');

        // Check if user is already logged in
        if(localStorage.getItem('adminLoggedIn') === 'true') {
            // User is already logged in, show dashboard
            loginScreen.style.display = 'none';
            dashboardContainer.style.display = 'block';
        } else {
            // User is not logged in, show login screen
            loginScreen.style.display = 'flex';
            dashboardContainer.style.display = 'none';
        }

        // Login form submission
        loginForm.addEventListener('submit', function(e) {
            e.preventDefault();

            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;

            // Simple authentication - in a real app, this would be more secure
            if(username === 'admin' && password === 'jehovah123') {
                // Successful login
                localStorage.setItem('adminLoggedIn', 'true');
                loginScreen.style.display = 'none';
                dashboardContainer.style.display = 'block';

                // Clear form
                document.getElementById('username').value = '';
                document.getElementById('password').value = '';

                // Show success message
                loginError.className = 'hidden mt-4 p-3 bg-green-100 text-green-700 rounded text-sm';
                loginError.textContent = 'Login successful! Redirecting...';
                loginError.style.display = 'block';

                // Hide error after 2 seconds
                setTimeout(function() {
                    loginError.style.display = 'none';
                }, 2000);
            } else {
                // Failed login
                loginError.className = 'mt-4 p-3 bg-red-100 text-red-700 rounded text-sm';
                loginError.textContent = 'Invalid username or password. Please try again.';
                loginError.style.display = 'block';

                // Clear password field
                document.getElementById('password').value = '';
            }
        });

        // Logout functionality
        logoutBtn.addEventListener('click', () => {
            if(confirm('Are you sure you want to logout?')) {
                // Clear login status
                localStorage.removeItem('adminLoggedIn');

                // Show login screen
                loginScreen.style.display = 'flex';
                dashboardContainer.style.display = 'none';

                // Clear form and error message
                document.getElementById('username').value = '';
                document.getElementById('password').value = '';
                loginError.style.display = 'none';
            }
        });
    </script>
</body>
</html>