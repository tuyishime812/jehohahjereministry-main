# Supabase Setup Guide for Jehovah Jire Ministry

This guide will help you set up Supabase as the database for your Jehovah Jire Ministry website.

## Step 1: Create a Supabase Account

1. Go to [supabase.com](https://supabase.com) and sign up for a free account
2. Create a new project
3. Note down your Project URL and Anonymous Key (found in Project Settings > API)

## Step 2: Set Up the Database Tables

Run these SQL commands in your Supabase SQL Editor:

### Content Table
```sql
CREATE TABLE content (
  id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  page TEXT NOT NULL,
  section TEXT NOT NULL,
  content TEXT,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  UNIQUE(page, section)
);

-- Enable Row Level Security
ALTER TABLE content ENABLE ROW LEVEL SECURITY;
ALTER TABLE content FORCE ROW LEVEL SECURITY;

-- Create policy to allow all operations (adjust as needed)
CREATE POLICY "Allow all operations" ON content FOR ALL USING (true);
```

### Media Table
```sql
CREATE TABLE media (
  id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  key TEXT NOT NULL UNIQUE,
  value TEXT,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- Enable Row Level Security
ALTER TABLE media ENABLE ROW LEVEL SECURITY;
ALTER TABLE media FORCE ROW LEVEL SECURITY;

-- Create policy to allow all operations (adjust as needed)
CREATE POLICY "Allow all operations" ON media FOR ALL USING (true);
```

## Step 3: Update Configuration Values

### For Admin Panel (admin-cms.html):
Find these lines in the script:
```javascript
const SUPABASE_URL = 'https://your-project.supabase.co'; // Replace with your Supabase project URL
const SUPABASE_KEY = 'your-anon-key'; // Replace with your Supabase anon key
```

Replace with your actual Supabase credentials:
- `SUPABASE_URL`: Your project URL from Project Settings > Configuration > API
- `SUPABASE_KEY`: Your anon key from Project Settings > API

### For Content Manager (content-manager.js):
Find these lines in the script:
```javascript
const SUPABASE_URL = 'https://your-project.supabase.co'; // Replace with your Supabase project URL
const SUPABASE_KEY = 'your-anon-key'; // Replace with your Supabase anon key
```

Replace with the same credentials as above.

## Step 4: Testing the Connection

1. Make sure your Supabase project is set up correctly
2. Update the configuration in both files
3. Test by saving content in the admin panel
4. Verify that content appears on your website

## Security Considerations

For production environments, consider updating the RLS policies to be more restrictive:

```sql
-- Example of more secure policies
CREATE POLICY "Allow read access" ON content FOR SELECT USING (true);
CREATE POLICY "Allow insert for authenticated users" ON content FOR INSERT WITH CHECK (auth.role() = 'authenticated');
CREATE POLICY "Allow update for authenticated users" ON content FOR UPDATE USING (auth.role() = 'authenticated');
```

## Troubleshooting

- Make sure your Supabase project allows requests from your domain
- Check that RLS policies are configured correctly
- Verify your API keys are correct
- Check browser console for error messages
- Ensure CORS settings allow your domain if needed

## Benefits of Using Supabase:

- Cloud-based storage accessible from anywhere
- Real-time collaboration between multiple admins
- Automatic backups and security
- Scalable infrastructure
- Free tier available
- PostgreSQL database with real-time capabilities
- Built-in authentication and authorization