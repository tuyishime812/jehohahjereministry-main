# Supabase Integration Guide

This guide explains how to connect your Ministry CMS to Supabase for cloud-based content management.

## Step 1: Create a Supabase Account

1. Go to [supabase.io](https://supabase.io) and sign up for a free account
2. Create a new project
3. Note down your Project URL and Anonymous Key (found in Project Settings > API)

## Step 2: Set Up the Database Table

Run this SQL in your Supabase SQL Editor:

```sql
CREATE TABLE content (
  id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  page TEXT NOT NULL,
  section TEXT NOT NULL,
  content TEXT,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  UNIQUE(page, section)
);

-- Enable Row Level Security
ALTER TABLE content ENABLE ROW LEVEL SECURITY;
ALTER TABLE content FORCE ROW LEVEL SECURITY;

-- Create policies (adjust as needed for your security requirements)
CREATE POLICY "Allow all operations" ON content FOR ALL USING (true);
```

## Step 3: Update Your Application Files

### For Admin Panel (admin-cms.html):

Find these lines near the top of the script:
```javascript
let SUPABASE_URL = null; // 'https://your-project.supabase.co'
let SUPABASE_KEY = null; // 'your-anon-key'
```

Replace with your actual Supabase credentials:
```javascript
let SUPABASE_URL = 'https://your-project.supabase.co';
let SUPABASE_KEY = 'your-anon-key-from-project-settings';
```

### For Content Manager (content-manager.js):

Find these lines near the top of the script:
```javascript
let SUPABASE_URL = null; // 'https://your-project.supabase.co'
let SUPABASE_KEY = null; // 'your-anon-key'
```

Replace with your actual Supabase credentials:
```javascript
let SUPABASE_URL = 'https://your-project.supabase.co';
let SUPABASE_KEY = 'your-anon-key-from-project-settings';
```

### Add Supabase Library

Add this script tag to the head of your HTML files (before other scripts):
```html
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
```

## Step 4: Initialize Supabase Client

In both files, after defining the URL and KEY variables, add:

```javascript
const supabase = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);
```

## Step 5: Test the Connection

1. Make sure your Supabase project is set up correctly
2. Update the configuration in both files
3. Test by saving content in the admin panel
4. Verify that content appears on your website

## Benefits of Using Supabase:

- Cloud-based storage accessible from anywhere
- Real-time collaboration between multiple admins
- Automatic backups and security
- Scalable infrastructure
- Free tier available

## Fallback Behavior:

If Supabase is not configured or unavailable, the system will automatically fall back to using browser localStorage, ensuring your site continues to function.

## Troubleshooting:

- Make sure your Supabase project allows requests from your domain
- Check that RLS policies are configured correctly
- Verify your API keys are correct
- Check browser console for error messages